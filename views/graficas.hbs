{{>navbar}}


<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<link rel="stylesheet" href="/public/stylesheets/style.css">
<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
<div class="col-lg-10 mx-auto p-4 py-md-5">
    <header class="d-flex align-items-center pb-3 mb-5 border-bottom ">
        Gráficas de datos agregados
    </header>


    <body class="d-flex flex-column min-vh-100">
        <main>

            <div class="container">
                <canvas id="myChart"></canvas>
            </div>
            <div class="container">
                <canvas id="myChartCiudad"></canvas>
            </div>
            <div class="container">
                <canvas id="myChartSexo"></canvas>
            </div>
            <div class="container">
                <canvas id="myChartEdades"></canvas>
            </div>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

            <script>
                console.log([parseInt({{PersonasEmetropes}}), parseInt({{PersonasHipermetropes}}), parseInt({{PersonasMiopes}}), parseInt({{Astigmatismo}}), parseInt({{AH}}), parseInt({{AM}})])
                const ctx = document.getElementById('myChart');


var total = 0; // Initialize total to 0

var personasEmetropes = parseInt({{PersonasEmetropes}});
var personasHipermetropes = parseInt({{PersonasHipermetropes}});
var personasMiopes = parseInt({{PersonasMiopes}});
var astigmatismo = parseInt({{Astigmatismo}});
var ah = parseInt({{HA}});
var am = parseInt({{MA}});

// Check if each element is not null and add it to the total
if (!isNaN(personasEmetropes)) {
  total += personasEmetropes;
}

if (!isNaN(personasHipermetropes)) {
  total += personasHipermetropes;
}

if (!isNaN(personasMiopes)) {
  total += personasMiopes;
}

if (!isNaN(astigmatismo)) {
  total += astigmatismo;
}

if (!isNaN(ah)) {
  total += ah;
}

if (!isNaN(am)) {
  total += am;
}
var eme=(personasEmetropes/total)*100
var hipermetropes = (personasHipermetropes / total) * 100;
var miopes = (personasMiopes / total) * 100;
var astigmatismo = (astigmatismo / total) * 100;
var ah = (ah/ total) * 100;
var am = (am / total) * 100;

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Emetropía', 'Hipermetropía', 'Miopía', "Astigmatismo", "AH", "AM"],
                        datasets: [{
                            label: 'Porcentaje',
                            data: [eme, hipermetropes, miopes, astigmatismo, ah, am],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                const ctx2 = document.getElementById('myChartCiudad');


                new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Torreón', 'Gómez', 'Lerdo', "Otros"],
                        datasets: [{
                            label: 'Número de personas',
                            data: [{{torreon}}, {{gomez}}, {{lerdo}}, {{otros}}],
                            borderWidth: 1
                        }]
                    }
                });
                const ctx3 = document.getElementById('myChartSexo');


   
                new Chart(ctx3, {
                    type: 'doughnut',
                    data: {
                        labels: ['Masculino', 'Femenino'],
                        datasets: [{
                            label: 'Número de personas',
                            data: [{{masculino}}, {{femenino}}],
                            borderWidth: 1
                        }]
                    }
                });
                const ctx4 = document.getElementById('myChartEdades');

                new Chart(ctx4, {
                    type: 'bar',
                    data: {
                        labels: ['Miopía', 'Astigmatismo', 'Emetropía'],
                        datasets: [{
                            label: 'Número de personas',
                            data: [1, 2, 3],
                            borderWidth: 1
                        }]
                    }
                });
            </script>
            <br>
            <button class="btn btn-primary" onclick="printPage()">Imprimir datos</button>

        </main>


    </body>


</div>
<script>
    function printPage() {
        window.print();
    }
</script>




{{>footer}}